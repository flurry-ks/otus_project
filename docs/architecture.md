# Архитектура

## Обоснование выбора архитектурного стиля
### Характеристики потоков данных:
1. Множество взаимодействующих компонентов: Данные поступают из различных источников (мобильное приложение, терминалы, CRM, оркестрация роботов), каждый из которых выполняет узкоспециализированные функции.
2. Масштабируемость и независимость: Требуется масштабировать отдельные сервисы, такие как “Управление заказами” и “Оплата заказов”, без влияния на другие части системы. Также система должна поддерживать увеличение количества пользователей, ресторанов и роботов, что требует возможности горизонтального масштабирования отдельных модулей в будущем.
3. Интеграция с внешними системами: API упрощают взаимодействие с CRM, 1С и платежными шлюзами.
4. Интеграция с существующей микросервисной архитектурой.
### Преимущества микросервисной архитектуры:
1. Изоляция сервисов: Позволяет обновлять и развертывать модули независимо.
2. Масштабируемость: Отдельные сервисы можно масштабировать в зависимости от нагрузки.
3. Гибкость и надежность: Отказ одного сервиса не влияет на работу всей системы.
### Вывод:
Микросервисная архитектура обеспечивает гибкость, масштабируемость и устойчивость системы, что соответствует требованиям потоков данных и интеграции с существующей архитектурой системы.

## Диаграмма компонентов
![Диаграмма компонентов C4](/docs/diagrams/C4.png)

## Информационные потоки
|Компонент-источник|Компонент-приемник|Передаваемая информация|
|----------------------|-----------------------|----------------------------|
|Веб-приложение<br>Мобильное приложение<br>Терминал самообслуживания<br>UI сотрудника|Аутентификация|Логин*<br>Пароль*|
|Аутентификация|Веб-приложение<br>Мобильное приложение<br>Терминал самообслуживания<br>UI сотрудника|Токен авторизации*|
|Управление ассортиментом|Веб-приложение<br>Мобильное приложение<br>Терминал самообслуживания<br>UI сотрудника|Меню<br>Товары<br>Комбонаборы<br>Комбобургеры<br>Категория товара<br>Раскладка ингредиентов для каждого товара<br>Акции|
|Веб-приложение<br>Мобильное приложение<br>Терминал самообслуживания|Корзина|Сущность Корзина {<br>Список товаров* {<br>id*<br>Стоимость*<br>Количество*<br>}}|
|Веб-приложение<br>Мобильное приложение<br>Терминал самообслуживания<br>UI сотрудника|Управление заказами|Сущность Заказ {<br>id заказа - при редактировании или отмене существующего заказа<br>Список товаров* {<br>id*<br>Стоимость*<br>Количество*<br>}<br>Стоимость заказа*<br>Статус заказа*<br>Способ получения*<br>Время получения*<br>Способ оплаты*<br>Дата создания заказа*<br>}<br>Токен авторизации|
|Управление заказами|Веб-приложение<br>Мобильное приложение<br>Терминал самообслуживания|id заказа<br>Список товаров*<br>Стоимость заказа*<br>Статус заказа*<br>Способ получения*<br>Время получения*<br>Способ оплаты*<br>Дата создания заказа*<br>Редирект на оплату заказа|
|Оплата заказов|Управление заказами|id заказа<br>Статус заказа* (включает информацию об оплате)|
|Управление заказами|Оркестрация роботов|id заказа*<br>Список товаров*|
|Оркестрация роботов|Управление заказами|id заказа*<br>Список товаров*<br>Статус по каждому товару в заказе|
|Управление заказами|Табло|id заказа*<br>Статус заказа*|
|Аутентификация|Компонент CRM|Данные об авторизации пользователя|
|Компонент CRM|Веб-приложение<br>Мобильное приложение<br>Терминал самообслуживания|Сущность Пользователь {<br>id пользователя<br>Имя<br>}<br>Сущность Начисленные баллы {<br>Количество баллов<br>Срок годности<br>Дата начисления<br>}<br>Список заказов|
|Веб-приложение<br>Мобильное приложение<br>Терминал самообслуживания|Оплата заказов|Стоимость заказа*<br>Способ оплаты*<br>id заказа*|
|Оплата заказов|Управление заказами|id заказа*<br>Статус оплаты заказа*<br>Дата и время оплаты*|
|Оплата заказов|Компонент 1С|Данные об оплатах заказов|
|Управление заказами|Компонент CRM|id пользователя<br>id заказа<br>Начисленные бонусы<br>Дата начисления|
|Управление заказами|Управление ассортиментом|Информация об изменении остатков<br>id заказа<br>id ингредиента|
