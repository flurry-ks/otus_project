# Архитектура

## Обоснование выбора архитектурного стиля
### Характеристики потоков данных:
	1.	Множество взаимодействующих компонентов: Данные поступают из различных источников (мобильное приложение, терминалы, CRM, оркестрация роботов), каждый из которых выполняет узкоспециализированные функции.
	2.	Масштабируемость и независимость: Требуется масштабировать отдельные сервисы, такие как “Управление заказами” и “Оплата заказов”, без влияния на другие части системы. Также система должна поддерживать увеличение количества пользователей, ресторанов и роботов, что требует возможности горизонтального масштабирования отдельных модулей в будущем.
	3.	Интеграция с внешними системами: API упрощают взаимодействие с CRM, 1С и платежными шлюзами.
### Преимущества микросервисной архитектуры:
	1.	Изоляция сервисов: Позволяет обновлять и развертывать модули независимо.
	2.	Масштабируемость: Отдельные сервисы можно масштабировать в зависимости от нагрузки.
	3.	Гибкость и надежность: Отказ одного сервиса не влияет на работу всей системы.
### Вывод:
Микросервисная архитектура обеспечивает гибкость, масштабируемость и устойчивость системы, что соответствует требованиям потоков данных и интеграции с существующей архитектурой системы.

## Диаграмма компонентов
![Диаграмма компонентов C4](/docs/diagrams/C4.png)

## Информационные потоки
|Компонент-источник|Компонент-приемник|Передаваемая информация|
|----------------------|-----------------------|----------------------------|
|Веб-приложение, Мобильное приложение, Терминал самообслуживания, UI сотрудника|Аутентификация|Логин*, Пароль*|
|Аутентификация|Веб-приложение, Мобильное приложение, Терминал самообслуживания, UI сотрудника|Токен авторизации*|
|Управление ассортиментом|Веб-приложение, Мобильное приложение, Терминал самообслуживания, UI сотрудника|Меню, Товары, Комбонаборы, Комбобургеры, Категория товара, Раскладка ингредиентов для каждого товара, Акции|
|Веб-приложение, Мобильное приложение, Терминал самообслуживания|Корзина|Сущность Корзина: Список товаров* (id*, Стоимость*, Количество*)|
|Веб-приложение, Мобильное приложение, Терминал самообслуживания, UI сотрудника|Управление заказами|Сущность Заказ: id заказа - при редактировании или отмене существующего заказа, Список товаров* (id*, Стоимость*, Количество*), Стоимость заказа*, Статус заказа*, Способ получения*, Время получения*, Способ оплаты*, Дата создания заказа*, Токен авторизации|
|Управление заказами|Веб-приложение, Мобильное приложение, Терминал самообслуживания|id заказа, Список товаров*, Стоимость заказа*, Статус заказа*, Способ получения*, Время получения*, Способ оплаты*, Дата создания заказа*, Редирект на оплату заказа|
|Оплата заказов|Управление заказами|id заказа, Статус заказа* (включает информацию об оплате)|
|Управление заказами|Оркестрация роботов|id заказа*, Список товаров*|
|Оркестрация роботов|Управление заказами|id заказа*, Список товаров*, Статус по каждому товару в заказе|
|Управление заказами|Табло|id заказа*, Статус заказа*|
|Аутентификация|Компонент CRM|Данные об авторизации пользователя|
|Компонент CRM|Веб-приложение, Мобильное приложение, Терминал самообслуживания|Сущность Пользователь (id пользователя, Имя), Сущность Начисленные баллы (Количество баллов, Срок годности, Дата начисления), Список заказов)
|Веб-приложение, Мобильное приложение, Терминал самообслуживания|Оплата заказов|Стоимость заказа*, Способ оплаты*, id заказа*|
|Оплата заказов|Управление заказами|id заказа*, Статус оплаты заказа*, Дата и время оплаты*|
|Оплата заказов|Компонент 1С|Данные об оплатах заказов|
|Управление заказами|Компонент CRM|id пользователя, id заказа, Начисленные бонусы, Дата начисления|
|Управление заказами|Управление ассортиментом|Информация об изменении остатков, id заказа, id ингредиента|
