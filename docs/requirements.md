# Требования к системе

## Нефункциональные требования

### Производительность
- Отклик системы должен составлять не более 1 мс.
- Система должна выдерживать пиковую нагрузку в 5 000 заказов в сутки.
- Система должна обеспечивать среднюю нагрузку в 2 000 заказов в сутки.
- Система должна обрабатывать 100 заказов одновременно.
- Система должна обеспечивать среднюю скорость приготовления заказа 2 минуты
- Система должна поддерживать работу 14 роботов.
### Безопасность
- Система не должна сохранять персональные данные неавторизованных клиентов.
- Система должна шифровать данные логин и пароль.
- Система должна обеспечивать ограничение ролей и доступов в систему:
  - авторизованный посетитель
  - неавторизованный посетитель
  - технолог
  - менеджер гостеприимства
### Масштабируемость
- Система должна обеспечивать масштабируемость до 10 000 пользователей в сутки с сохранением текущего уровня производительности.
- Система должна поддерживать масштабирование для роботизации 25 действующих ресторанов сети через 3 года и 71 ресторана сети — через 5 лет.
### Совместимость
- Должна быть интеграция с текущей CRM-системой.
- Должна быть интеграция с текущей системой 1C.
- Должна быть интеграция с текущей системой закупок, управления ассортиментом и учета остатков.
- Должна быть интеграция с текущей системой заказов.
- Должна быть интеграция с текущей системой роботов.
- Необходимо использовать текущую интеграцию с платежными системами.
### Доступность
- Система должна быть доступна 99% времени.
- Необходимо обеспечить круглосуточную работу системы.
### Концептуальная целостность
- Мобильное приложение должно быть разработано на Flutter.
- Backend должен быть разработан на Java.
- Тачпойнт для заказа в ресторане должен быть разработан на Java.
- Система должна использовать российскую облачную инфраструктуру.
### Возможность повторного использования
- Система должна быть масштабируема на другие рестораны сети.
### Поддерживаемость
- Система должна логировать действия роботов.

## Функциональные требования

### Диаграмма вариантов использования
[Ссылка на диаграмму вариантов использования на языке PluntUML](/docs/diagrams/usecase.puml)
![Диаграмма вариантов использования](/docs/diagrams/usecase.png)

### Варианты использования

|Вариант использования|Оформить заказ в мобильном приложении|
|---------------------|-------------------------------------|
|Описание             |Посетитель может оформить заказ мобильном приложении.|
|Предусловия          |1. Открыт торговый день<br/>2. В ассортименте есть блюда, доступные для заказа|
|Постусловия          |1. Заказ поступил в производство<br/>2. Зафиксирована запись об оплате в кассовой системе|
|Основной сценарий       |1. Посетитель открывает мобильное приложение<br/>2. [Переход к сценарию "Посмотреть меню"](#menu)<br/>3. [Переход к сценарию "Добавить позицию в корзину"](#add_position)<br/>4. Посетитель открывает корзину и проверяет выбранные товары.<br/>5. Посетитель нажимает “Оформить заказ”.<br/>6. Система спрашивает, является ли посетитель участником нашей программы лояльности<br/>7. [Переход к сценарию "Авторизоваться в программе лояльности"](#authorization)<br/>8. Система предлагает выбрать способ получения заказа (самовывоз, в зале).<br/>9. Посетитель указывает, где будет есть: с собой или в зале<br/>10. Система предлагает выбрать способ оплаты<br/>11. Пользователь выбирает способ оплаты<br/>12. Система формирует заказ, присваивает ему уникальный ID и направляет посетителя на страницу оплаты (если применимо)<br/>13. [Переход к сценарию "Оплатить заказ"](#pay)<br/>14. Система отображает информацию о заказе|
|Альтернативный сценарий  |7.a. Посетитель отказывается авторизоваться в программе лояльности<br/>1. Сценарий продолжается с шага 8 основного потока<br/><br/>11.a. Сумма заказа более 1500 рублей или в заказе есть специальное комбо<br/>1. Система добавляет в заказ подарок<br/>2. Сценарий продолжается с шага 12 основного потока<br/><br/>11.b. Заказ происходит в будние дни с 10:00 до 16:00 по местному времени<br/>1. Система делает скидку<br/>2. Сценарий продолжается с шага 12 основного потока|
|Прерывание процесса   |1. Система позволяет на каждом шаге вернуться в главное меню, не теряя черновик корзины.<br/>2. Система на любом шаге позволяет завершить процесс оформления заказа.|

|Вариант использования|<a name="menu"><a/>Посмотртеть меню|
|---------------------|-----------------------------------|
|Описание|Посетитель может посмотреть позиции меню с разбивкой по категориям|
|Предусловия|1. В ассортименте есть блюда, доступные для заказа.<br/>2. Посетитель запустил приложение.|
|Постусловия|1. Посетитель получил доступ к списку доступных товаров|
|Основной сценарий|1. Посетитель выбирает раздел “Меню”.<br/>2. Система отображает доступные категории меню<br/>3. Посетитель выбирает категорию<br/>4. Система совершает скролл до выбранной категории<br/>5. Посетитель при помощи скролла просматривает позиции меню|
|Альтернативный сценарий|5.a. Посетитель выбирает другую категорию<br/>1. Сценарий продолжается с шага 4 основного потока.|
|Расширения|1. Посетитель выбирает товар.  [Переход к сценарию "Посмотреть информацию о позиции меню"](#position) 

|Вариант использования|<a name="position"><a/>Посмотреть информацию о позиции меню|
|---------------------|---------------------------------------------------------|
|Описание|Посетитель может посмотреть подробную информацию о позиции меню: фото, описание, состав, пищевую ценность|
|Предусловия|1. В ассортименте есть блюда, доступные для заказа|
|Постусловия|Система отобразила подробную информацию о выбранной позиции|
|Основной сценарий|1. Посетитель открывает приложение.<br/>2. Система отображает главный экран приложения с меню.<br/>3. Посетитель нажимает на карточку выбранной позиции.<br/>4. Система открывает экран с подробной информацией о позиции.|
|Альтернативный сценарий|3.a. Посетитель нажимает кнопку добавления позиции в корзину<br/>1. [Переход к сценарию "Добавить позицию в корзину"](#add_position)|
|Прерывание процесса|1. Система позволяет на каждом шаге вернуться в главное меню|

|Вариант использования|<a name="add_position"><a/>Добавить позицию в корзину|
|-----------------------|---------------------------------------------------------|
|Описание|Посетитель добавляет выбранный товар в корзину для оформления заказа.|
|Предусловия|1. В ассортименте есть блюда, доступные для заказа.<br/>2. Посетитель выбрал интересующую его позицию в меню.|
|Постусловия|1. Товар добавлен в корзину.<br/>2. Посетитель может продолжить выбор товаров или перейти к оформлению заказа.|
|Основной сценарий|1. Посетитель нажимает на кнопку добавления позиции в корзину в карточке позиции.<br/>2. Система добавляет позицию в корзину и уведомляет посетителя об успешном добавлении.<br/>3. Система изменяет счетчик количества позиций в корзине на 1.|
|Альтернативный сценарий|1.a. Пользователь осуществляет переход на экран с подробной информацией о позиции.<br/>1.Пользователь выбирает количество товара.<br/>2. Пользователь нажимает кнопку добавления позиции в корзину на экране с подробной информацией.<br/>3. Сценарий продолжается с шага 2 основного потока.<br/><br/>3.a. Пользователь хочет добавить позицию повторно.<br/>1. Сценарий продолжается с шага 1 основного потока.|
|Расширения|2а. Если позиция уже добавлена в корзину, система предлагает изменить ее количество.|

| Вариант использования | Изменить содержимое корзины |
|------------------------|-----------------------------|
| Описание               | Посетитель хочет добавить, изменить или удалить товары в корзине перед оформлением заказа. |
| Предусловия            | 1. Корзина уже содержит хотя бы одну позицию. |
| Постусловия            | 1. Содержимое корзины обновлено в системе. <br> 2. Итоговая стоимость корзины актуализирована. |
| Основной сценарий      | 1. Посетитель открывает раздел корзины. <br> 2. Посетитель выбирает товар в корзине. <br> 3. Посетитель редактирует количество товара, удаляет его или добавляет новый товар. <br> 4. Система пересчитывает итоговую стоимость корзины. <br> 5. Обновленные данные корзины сохраняются. |
| Исключения             | 1. Ошибка при сохранении изменений: система уведомляет посетителя и предлагает повторить операцию. |

|Вариант использования:|<a name="pay"><a/>Оплатить заказ|
|-----------------------|---------------------------------------------------------|
|Описание|Посетитель оплачивает заказ выбранным способом.|
|Предусловия|1. У пользователя есть действующий заказ для оплаты.|
|Постусловия|1. Заказ оплачен, и данные о транзакции успешно сохранены.<br/>2. Пользователь получает подтверждение в приложении.<br/>3. Заказ передаётся в работу.|
|Основной сценарий|1. Пользователь переходит на экран оплаты.<br/>2. Система предлагает пользователю выбор способа оплаты: СБП, банковская карта, бонусы.<br/>3. Пользователь выбирает желаемый способ оплаты.<br/>4. Система перенаправляет посетителя на страницу оплаты и отображает экран ввода данных в соответствии со способом оплаты.<br/>5. Пользователь вводит необходимые данные и подтверждает оплату.<br/>6. Система отправляет данные на сервер для обработки платежа через выбранную платежную систему.<br/>7. Платежная система обрабатывает запрос и возвращает статус транзакции.<br/>8. Система отправляет данные в систему управления заказами.<br/>9. Система уведомляет посетителя об успешной оплате.<br/>9. Пользователь получает подтверждение заказа и чек.|
|Альтернативный сценарий|2a. Пользователь не авторизован в системе.<br/>1. Система НЕ предлагает способ оплаты бонусами..<br/>.<br/>7a. Платежная система возвращает ошибку.<br/>1. Система уведомляет пользователя о неудачной транзакции и предлагает выбрать другой метод оплаты или повторить попытку.|
|Расширения|3a. Если посетитель выбрал оплату бонусами, система проверяет достаточность баллов.<br/>3b. Если баллов недостаточно, система уведомляет посетителя и предлагает выбрать другой способ оплаты.|

| Вариант использования | <a name="authorization"><a/>Авторизоваться в программе лояльности |
|------------------------|---------------------------------------|
| Описание               | Посетитель хочет получить доступ к своему профилю в программе лояльности. |
| Предусловия            | 1. Посетитель зарегистрирован в программе лояльности. <br> 2. У пользователя есть доступ к веб-приложению, мобильному приложению или терминалу самообслуживания. |
| Постусловия            | 1. Посетитель успешно авторизован и может просматривать/управлять своими данными в программе лояльности. |
| Основной сценарий      | 1. Посетитель выбирает опцию "Авторизоваться" в приложении. <br> 2. Система запрашивает логин (номер телефона или email) и пароль. <br> 3. Посетитель вводит данные и подтверждает вход. <br> 4. Система проверяет корректность данных. <br> 5. При успешной проверке система выдает посетителю токен авторизации и предоставляет доступ к функционалу программы лояльности. |
| Альтернативный сценарий   |1a. Посетитель не зарегистрирован в программе лояльности.<br>1a.1.[Переход к сценарию "Зарегистрироваться в программе лояльности"](#registration)|  4a. Введенные данные неверны: <br>4a.1. Система сообщает об ошибке и предлагает повторить попытку. <br><br> 4b. Посетитель забыл пароль: <br>4b.1. Система предлагает восстановить пароль через email или SMS. |
| Исключения             | 1. Ошибка сети: система уведомляет об отсутствии соединения и предлагает повторить позже. |

|Вариант использования   |<a name="registration"><a/>Зарегистрироваться в программе лояльности|
|------------------------|-------------------------------------------|
| Описание               | Посетитель хочет зарегистрироваться в программе лояльности, чтобы получать бонусы и персональные предложения. |
| Предусловия            | Посетитель имеет доступ к мобильному приложению|
| Постусловия            | 1. Посетитель успешно зарегистрирован и может авторизоваться в программе лояльности. <br> 2. Система создает учетную запись и начисляет приветственные бонусы (если предусмотрено). |
| Основной сценарий      | 1. Посетитель выбирает опцию "Регистрация". <br> 2. Система запрашивает данные: ФИО, номер телефона, email и пароль. <br> 3. Посетитель вводит данные и подтверждает регистрацию. <br> 4. Система проверяет корректность данных и регистрирует посетителя. <br> 5. Система отправляет подтверждение регистрации на указанный email или номер телефона. |
| Альтернативный сценарий | 3a. Введенные данные некорректны (например, телефон уже зарегистрирован): <br><br>3a.1. Система сообщает о некорректности данных и предлагает их исправить. <br> 5a. Ошибка отправки подтверждения:<br><br>5a.1. Система уведомляет об ошибке и предлагает повторить попытку позже. |

|Вариант использования|Посмотреть информацию в личном кабинете|
|---------------------|---------------------------------------------------------|
|Описание|Посетитель открывает личный кабинет для просмотра персональной информации, истории заказов, бонусного баланса и связанных данных.|
|Предусловия|Посетитель авторизован в системе.|
|Постусловия|Система предоставляет актуальную информацию о пользователе.|
|Основной поток|1. Посетитель переходит в раздел личного кабинета.<br>2.	Система отображает информацию о пользователе, включая: ФИО; Контактные данные; Бонусный баланс; Историю заказов; Список активных акций.|
|Альтернативный поток|2a. Если данные о пользователе временно недоступны:<br>2a.1.	Система отображает сообщение об ошибке и предлагает повторить попытку позже.|
|Расширения|Пользователь может изменить ФИО и Контактные данные|

| Вариант использования | Получить заказ |
|-----------------------|----------------|
|Описание               |Посетитель хочет получить заказ, оформленный через приложение|
|Предусловия            |1. Посетитель ранее оформил заказ. <br> 2. Заказ готов к выдаче (статус заказа: "Готов").|
|Постусловия            |1. Заказ помечается как выданный. <br> 2. Статус заказа обновляется в системе.|
|Основной сценарий      |1. Посетитель подходит к зоне выдачи заказов. <br> 2. Посетитель вводит номер заказа или сканирует QR-код. <br> 3. Система находит заказ по номеру/QR-коду. <br> 4. Роботизированная система подготавливает заказ к выдаче. <br> 5. Система уведомляет посетителя, что заказ можно забрать. <br> 6. Посетитель забирает заказ. |
|Альтернативный сценарий| 3a. Номер заказа не найден: <br>3a.1. Система сообщает об ошибке и предлагает повторить ввод или обратиться к менеджеру по гостеприимству. <br><br> 4a. Роботизированная система испытывает сбой:<br>4a.1. Менеджеру по гостеприимству вручную помогает выдать заказ. |
|Исключения             | 1. Посетитель ввёл неверный номер несколько раз: заказ блокируется для дополнительной проверки менеджером по гостеприимству.|

|Вариант использования|Посмотреть статус заказа|
|---------------------|---------------------------------------------------------|
|Описание|Посетитель отслеживает статус своего заказа через приложение или на табло в ресторане.|
|Предусловия|1. Посетитель оформил и НЕ получил заказ.<br/>2. Для просмотра статуса заказа в приложении - открыт раздел “Мои заказы”.|
|Постусловия|Посетитель получает актуальную информацию о статусе своего заказа.|
|Основной сценарий|1. Система отображает текущий статус заказа в приложении или на табло в ресторане|
|Расширения|Посетитель может увидеть детали заказа (например, состав заказа и время готовности)|
